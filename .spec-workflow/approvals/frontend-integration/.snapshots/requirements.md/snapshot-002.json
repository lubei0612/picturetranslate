{
  "id": "snapshot_1764816820438_jqsmiisnk",
  "approvalId": "approval_1764771090564_tzdloln5q",
  "approvalTitle": "Requirements: 前后端分离集成方案",
  "version": 2,
  "timestamp": "2025-12-04T02:53:40.438Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Requirements Document: Frontend Integration\n\n## Introduction\n\n将 picturetranslate 后端服务与 crossborder-ai React 前端整合，实现前后端分离的完整图片翻译产品。后端提供 FastAPI 翻译 API，前端提供专业的 Dashboard 和 Editor 界面。\n\n## Alignment with Product Vision\n\n- **目标用户**: 跨境电商卖家\n- **核心价值**: 专业的图片翻译工具，提供比 Streamlit 更好的用户体验\n- **部署方式**: 后端 Dokploy Docker，前端 Vercel/Netlify\n\n## Requirements\n\n### Requirement 1: FastAPI 后端 API\n\n**User Story:** 作为前端开发者，我需要一个标准的 REST API，以便前端能够调用翻译服务。\n\n#### Acceptance Criteria\n\n1. WHEN 前端发送 POST /api/translate 请求 THEN 系统 SHALL 返回翻译后的图片 (base64)\n2. IF 图片超过 10MB 或 8192px THEN 系统 SHALL 返回 400 错误和具体原因\n3. WHEN 翻译成功 THEN 响应 SHALL 包含 translated_image、original_size 字段\n4. IF 阿里云 API 调用失败 THEN 系统 SHALL 返回 500 错误和错误信息\n\n### Requirement 2: 前端上传集成\n\n**User Story:** 作为用户，我想在 Dashboard 页面上传图片并选择语言，以便开始翻译任务。\n\n#### Acceptance Criteria\n\n1. WHEN 用户拖拽或点击上传图片 THEN 系统 SHALL 显示上传进度\n2. WHEN 用户选择源语言和目标语言 THEN 系统 SHALL 保存设置\n3. WHEN 点击翻译按钮 THEN 系统 SHALL 调用后端 API 并显示加载状态\n4. IF 翻译成功 THEN 系统 SHALL 跳转到 Editor 页面显示结果\n\n### Requirement 3: 结果预览与下载\n\n**User Story:** 作为用户，我想在 Editor 页面对比原图和译图，并下载翻译结果。\n\n#### Acceptance Criteria\n\n1. WHEN 进入 Editor THEN 系统 SHALL 左右并排显示原图和译图\n2. WHEN 用户点击下载按钮 THEN 系统 SHALL 下载 PNG 格式的翻译结果\n3. WHEN 用户点击返回 THEN 系统 SHALL 回到 Dashboard 页面\n\n### Requirement 4: 错误处理与反馈\n\n**User Story:** 作为用户，我希望在出错时看到清晰的错误提示，以便了解问题所在。\n\n#### Acceptance Criteria\n\n1. IF 网络请求超时 THEN 系统 SHALL 显示 \"请求超时，请重试\"\n2. IF 图片格式不支持 THEN 系统 SHALL 显示 \"仅支持 JPG、PNG、WebP 格式\"\n3. IF 后端返回错误 THEN 系统 SHALL 显示具体错误信息\n\n## Non-Functional Requirements\n\n### Code Architecture and Modularity\n\n- **后端**: FastAPI + processor.py 核心逻辑复用\n- **前端**: React + TypeScript，services 层封装 API 调用\n- **接口契约**: OpenAPI/Swagger 文档\n\n### Performance\n\n- 单图翻译响应时间 < 10s\n- 支持 1-2 并发用户 (MVP 阶段)\n- 图片上传支持断点续传 (可选)\n\n### Security\n\n- CORS 配置仅允许前端域名\n- 环境变量存储敏感信息\n- 请求频率限制 (5 QPS)\n\n### Reliability\n\n- 后端健康检查端点 /health\n- 翻译失败自动重试 (最多 3 次)\n- 超时回退机制\n\n### Usability\n\n- 拖拽上传支持\n- 加载状态动画\n- 移动端适配 (基础)\n\n## Technical Constraints\n\n| 约束 | 值 |\n|------|-----|\n| 后端框架 | FastAPI |\n| 前端框架 | React 19 + TypeScript |\n| 图片限制 | 10MB, 8192x8192 |\n| 目标语言 | 中/英/日/德/法/西/韩/俄 |\n| 部署 | Docker (Dokploy) |\n\n## Out of Scope (MVP)\n\n- 用户认证系统\n- 批量图片处理\n- 历史记录持久化\n- 图层手动编辑功能\n- 付费计费系统\n",
  "fileStats": {
    "size": 3432,
    "lines": 106,
    "lastModified": "2025-12-03T14:11:18.637Z"
  },
  "comments": []
}